{
    "MascheraCambio": [
        {
            "parentClass": "MascheraCambio",
            "name": "MascheraCambio",
            "sourceCode": "public MascheraCambio(Frame parent)\n\t{\n      super(\"Cambio di stanza\");\n      padre = parent;\n      padre.setEnabled(false);\n      setup();\n      init();\n      pack();\n      this.setVisible(true);\n\t}"
        },
        {
            "parentClass": "MascheraCambio",
            "name": "setup",
            "sourceCode": "void setup()\n\t{\n\t  this.setFont(ConfigurazioneSistema.font_base);\n      stanza1 = new TextField(\"\", 4);\n      stanza2 = new TextField(\"\", 4);\n      stanza2.setEditable(false);\n      etichetta1 = new Label(\"Stanza attuale\");\n      etichetta2 = new Label(\"     Nuova stanza\");\n      Annulla = new Button(\" Annulla \");\n      Ricerca = new Button(\" Ricerca \");\n      Conferma = new Button(\"Conferma\");\n      Conferma.setEnabled(false);\n\t\t\t\t\n      panel1 = new Panel();\n      panel1.setLayout(gridbag);\n      Utils.constrain(panel1, etichetta1, 0, 0, 1, 1, GridBagConstraints.NONE,\n                     GridBagConstraints.NORTHWEST, 0.0, 0.0, 0, 0, 0, 0);\n      Utils.constrain(panel1, stanza1,    1, 0, 1, 1, GridBagConstraints.NONE,\n                     GridBagConstraints.NORTHWEST, 0.0, 0.0, 0, 0, 0, 0);\n      Utils.constrain(panel1, etichetta2, 2, 0, 1, 1, GridBagConstraints.NONE,\n                     GridBagConstraints.NORTHWEST, 0.0, 0.0, 0, 0, 0, 0);\n      Utils.constrain(panel1, stanza2,    3, 0, 1, 1, GridBagConstraints.NONE,\n                     GridBagConstraints.NORTHWEST, 0.0, 0.0, 0, 0, 0, 0);\n\n      panel2 = new Panel();\n      panel2.setLayout(gridbag);\n      Utils.constrain(panel2, Annulla,  0, 1, 1, 1, GridBagConstraints.NONE,\n                        GridBagConstraints.CENTER, 0.0, 0.0, 0, 0, 0, 0);\n      Utils.constrain(panel2, Ricerca,  1, 1, 1, 1, GridBagConstraints.NONE,\n                        GridBagConstraints.CENTER, 0.0, 0.0, 0, 0, 0, 0);\n      Utils.constrain(panel2, Conferma, 2, 1, 1, 1, GridBagConstraints.NONE,\n                        GridBagConstraints.CENTER, 0.0, 0.0, 0, 0, 0, 0);                  \n\n      \n      this.setLayout(gridbag);\n      Utils.constrain(this, panel1, 0, 0, 1, 1, GridBagConstraints.BOTH,\n                        GridBagConstraints.WEST, 1.0, 1.0, 10, 10, 10, 10);\n      Utils.constrain(this, panel2, 0, 1, 1, 1, GridBagConstraints.BOTH,\n                        GridBagConstraints.EAST, 1.0, 1.0, 10, 10, 10, 10);\n\t}"
        },
        {
            "parentClass": "MascheraCambio",
            "name": "init",
            "sourceCode": "public void init()\n\t{\n      \n      \n      Annulla.addActionListener(new ActionListener()\n      {\n         public void actionPerformed(ActionEvent e)\n         {\n            dispose();\n            padre.setEnabled(true);\n         }\n      });\n\n      Conferma.addActionListener(new ActionListener()\n      {\n         public void actionPerformed(ActionEvent e)\n         {\n\t\t\tstartConferma();\n         }\n      });\n      \n      Ricerca.addActionListener(new ActionListener()\n      {\n         public void actionPerformed(ActionEvent e)\n         {\n\t\t\tif (noErrors()) \n\t\t\t{\t\n\t\t\t\t//stanza1.setEditable(false);\n\t\t\t\tstartRicerca();\n         \t}\n         }\n      });\n\t}"
        },
        {
            "parentClass": "MascheraCambio",
            "name": "startConferma",
            "sourceCode": "void startConferma()\n\t{\n\t\tFrame msg;\n\t\tListaDisponibilita elenco_disp = (Principale.db).elencoDisponibilita();\n\t\tif (elenco_disp == null)\n\t\t{\n\t\t\tmsg = new MessageDialog(this, \" Problemi con il database nella lettura delle disponibilita'! \");\n\t\t\treturn;\n\t\t}\n\t\telse\n\t\t{   \n\t\t\tif (ctrlPosti())\n\t\t\t{\n\t\t\t\tint ris;\n\t\t\t\tif ( (ris = (Principale.db).changeStanzaSoggiornanti(stanza1.getText(), stanza2.getText())) > 0 )\n\t\t\t\t{\n\t\t\t\t\tif ( (ris = (Principale.db).changeStanzaAddebiti(stanza1.getText(), stanza2.getText())) < 0 )\n\t\t\t\t\t\t\tmsg = new MessageDialog(this, \"Problemi con il database: \"+DataBase.strErrore(ris));\n\t\t\t\t\tif ( (ris = (Principale.db).changeStanzaTelefonate(stanza1.getText(), stanza2.getText())) < 0 )\n\t\t\t\t\t\t\tmsg = new MessageDialog(this, \"Problemi con il database: \"+DataBase.strErrore(ris));\n\t\t\t\t\tUtils.aggiornaDisp(elenco_disp,stanza1.getText(),p.getInizioSogg(),p.getFineSogg(),Flag.DISPONIBILE,Flag.OCCUPATA,true);\t\t\n\t\t\t\t\tUtils.aggiornaDisp(elenco_disp,stanza2.getText(),p.getInizioSogg(),p.getFineSogg(),Flag.OCCUPATA,Flag.DISPONIBILE,true);\t\t\n\t\t\t\t\tUtils.aggiornaDisp(elenco_disp,stanza2.getText(),p.getInizioSogg(),p.getFineSogg(),Flag.OCCUPATA,Flag.COMMISSIONATA,true);\t\t\n\t\t\t\t\n\t\t\t\t\tUtils.aggiornaDisp(elenco_disp,stanza2.getText(),p.getInizioSogg(),p.getFineSogg(),Flag.OCCUPATA,Flag.DISPONIBILE,true);\t\t\n\t\t\t\t\tUtils.aggiornaDisp(elenco_disp,stanza2.getText(),p.getInizioSogg(),p.getFineSogg(),Flag.OCCUPATA,Flag.COMMISSIONATA,true);\t\t\n\t\t\t\t\tif (p.getTramiteAgenzia() == Const.SI)\n\t\t\t\t\t{\t\n\t\t\t\t\t\tUtils.restoreCommissioni(stanza1.getText());\n\t\t\t\t\t}\n\t\t\t\t\tmsg = new AvvisoDialog(this,\"La stanza e' stata cambiata e tutti i dati riferiti ad essa aggiornati\");\n\t\t\t\t\tConferma.setEnabled(false);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t\tif ( (ris != 0) && (!(ris == DataBase.DONT_EXISTS_STANZA) ) )\n\t\t\t\t\t\tmsg = new MessageDialog(this, \"Problemi con il database: \"+DataBase.strErrore(ris));\n\t\t\t}\n\t\t}\n\t}"
        },
        {
            "parentClass": "MascheraCambio",
            "name": "ctrlPosti",
            "sourceCode": "boolean ctrlPosti()\n\t{\n\t\tFrame msg;\n\t\tListaSoggiornanti L_sogg = (Principale.db).foundSoggiornanti(stanza1.getText(),false);\n\t\tStanza room2 = (Principale.db).readStanza(stanza2.getText());\n\t\tif ( !(room2 ==null) && !(L_sogg == null))\n\t\t\tif\t(L_sogg.length() > contaPosti(room2))\n\t\t\t{\t\n\t\t\t\tmsg = new AvvisoDialog(this,\"La stanza scelta e' troppo piccola per \"+L_sogg.length()+\" persone\"); \t\t\t\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\telse \n\t\t\t return true;\n\t\telse\n\t\t{\n\t\t \tmsg = new MessageDialog(this,\" Problemi con il database! \");\n\t\t\treturn false;\n\t\t}\n\t}"
        },
        {
            "parentClass": "MascheraCambio",
            "name": "contaPosti",
            "sourceCode": "int contaPosti(Stanza s)\n\t{\n\t\tint c = s.getPostiLetto();\n\t\tif (s.getDispLettoAgg() == Const.SI)\n\t\t\tc++;\n\t\treturn c;\t\n\t}"
        },
        {
            "parentClass": "MascheraCambio",
            "name": "startRicerca",
            "sourceCode": "void startRicerca()\n\t{\n\t\tthis.setEnabled(false);\n\t\tfiglio = new MascheraRicercaStanza(\"Ricerca di stanze disponibili per cambio stanza\",3);\n\t\tSoggiornante sogg = (Principale.db).readSoggiornante(stanza1.getText(),1);\n\t\tp = (Principale.db).readPrenotazione(sogg.getIdPrenotazione());\n\t\tif ( !(p == null))\n\t\t{\t\n\t\t\tfiglio.data_inizio.setText(DateUtils.parseDate(DateUtils.giveStringOfDate(new Date())));\n\t\t\tfiglio.data_inizio.setEditable(false);\n\t\t\tfiglio.data_fine.setText(DateUtils.parseDate(DateUtils.giveStringOfDate(p.getFineSogg())));\n\t\t\tfiglio.save_date = p.getFineSogg();\n\t\t\tif (p.getTramiteAgenzia() == Const.SI)\n\t\t\t{\n\t\t\t\tfiglio.con_ag.setState(true);\n\t\t\t\tfiglio.con_ag.setEnabled(false);\n\t\t\t\tfiglio.nome_ag.setText(p.getNomeAgenzia());\n\t\t\t\tfiglio.nome_ag.setEditable(false);\n\t\t\t}\t\n\t\t\tfiglio.setVisible(true);\n\t\t\tfiglio.father = this;\n\t\t}\n\t}"
        },
        {
            "parentClass": "MascheraCambio",
            "name": "noErrors",
            "sourceCode": "boolean noErrors()\n\t{\n\t\tFrame msg;\n\t\tDisponibilita disp = new Disponibilita();\n\t\tListaDisponibilita elenco_disp = (Principale.db).elencoDisponibilita();\n\t\t\n\t\tif (elenco_disp == null)\n\t\t{\n\t\t\tmsg = new MessageDialog(this, \" Problemi con il database nella lettura delle disponibilita'! \");\n\t\t\treturn false;\n\t\t}\n\t\t\n\t\tif ((stanza1.getText().equals(\"\")) ) \n\t\t{\n\t\t\tmsg = new AvvisoDialog(this,\" Inserire il numero della stanza da cambiare! \");\n\t\t\treturn false;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif( (Principale.db).readStanza(stanza1.getText()) == null )\n\t\t\t{\n\t\t\t\tmsg = new MessageDialog(this,\" La stanza inserita e' inesistente! \");\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\telse\n\t\t\t{\t\n\t\t\t\tdisp = Utils.getDispOfRoom(elenco_disp, stanza1.getText(), true);\n\t\t\t\tif (disp != null)\n\t\t\t\t{\n\t\t\t\t\tif (  disp.getStatusGiorno(DateUtils.dataTogiorni(new Date()),Const.ANNO_CORRENTE) != Flag.OCCUPATA )\n\t\t\t\t\t{\t\n\t\t\t\t\t\tmsg = new MessageDialog(this,\" La stanza inserita non e' attualmente occupata! \");\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn true;\t\n\t}"
        }
    ]
}