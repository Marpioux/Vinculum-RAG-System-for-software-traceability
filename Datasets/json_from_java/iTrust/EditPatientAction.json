{
    "EditPatientAction": [
        {
            "parentClass": "EditPatientAction",
            "name": "EditPatientAction",
            "sourceCode": "public EditPatientAction(DAOFactory factory, long loggedInMID, String pidString) throws iTrustException {\r\n\t\tsuper(factory, pidString);\r\n\t\tthis.patientDAO = factory.getPatientDAO();\r\n\t\tthis.transDAO = factory.getTransactionDAO();\r\n\t\tthis.loggedInMID = loggedInMID;\r\n\t\temailutil = new EmailUtil(factory);\r\n\t}"
        },
        {
            "parentClass": "EditPatientAction",
            "name": "updateInformation",
            "sourceCode": "public void updateInformation(PatientBean p) throws iTrustException, FormValidationException {\r\n\t\tp.setMID(pid); // for security reasons\r\n\t\tvalidator.validate(p);\r\n\t\tpatientDAO.editPatient(p);\r\n\t\ttransDAO.logTransaction(TransactionType.ENTER_EDIT_DEMOGRAPHICS, loggedInMID, pid, \"EditPatient - Made Changes\");\r\n\t\temailutil.sendEmail(makeEmail());\r\n\t}"
        },
        {
            "parentClass": "EditPatientAction",
            "name": "getPatient",
            "sourceCode": "public PatientBean getPatient() throws DBException {\r\n\t\ttransDAO.logTransaction(TransactionType.ENTER_EDIT_DEMOGRAPHICS, loggedInMID, pid, \"EditPatient - View Patient\");\r\n\t\treturn patientDAO.getPatient(this.getPid());\r\n\t}"
        },
        {
            "parentClass": "EditPatientAction",
            "name": "makeEmail",
            "sourceCode": "private Email makeEmail() throws DBException{\r\n\r\n\t\tEmail email = new Email();\r\n\t\tList<PatientBean> reps = patientDAO.getRepresenting(pid);\r\n\t\tPatientBean pb = patientDAO.getPatient(pid);\r\n\t\t\r\n\t\tList<String> toAddrs = new ArrayList<String>();\r\n\t\ttoAddrs.add(pb.getEmail());\r\n\t\tfor (PatientBean r: reps) {\r\n\t\t\ttoAddrs.add(r.getEmail());\r\n\t\t}\r\n\t\t\r\n\t\temail.setFrom(\"no-reply@itrust.com\");\r\n    \temail.setToList(toAddrs); // patient and personal representative\r\n    \temail.setSubject(String.format(\"Patient Information Updated\"));\r\n    \temail.setBody(\"Dear \" + pb.getFullName() + \",\\n\\tYour patient record information has been updated. \" + \r\n    \t\t\t\"Please login to iTrust to see who has viewed your records.\");\r\n\t\treturn email;\r\n\t}"
        },
        {
            "parentClass": "EditPatientAction",
            "name": "editMessageFilter",
            "sourceCode": "public void editMessageFilter(String filter) throws iTrustException, FormValidationException {\r\n\t\tPatientBean b = this.getPatient();\r\n\t\tb.setMessageFilter(filter);\r\n\t\tthis.updateInformation(b);\r\n\t}"
        }
    ]
}